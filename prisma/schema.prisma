generator client {
  provider = "go run github.com/steebchen/prisma-client-go"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  FirstName     String
  LastName      String
  Email         String   @unique
  Password      String
  Username      String   @unique

  SolvedEasy    Int[]    @default([])
  SolvedMedium  Int[]    @default([])
  SolvedHard    Int[]    @default([])

  EarnedPoints  Int      @default(0)
  CurrentLevel  Int      @default(1)
  CurrentStreak Int      @default(0)
  MaxStreak     Int      @default(0)

  Links         String[] @default([])
  PhoneNumber   String?

  Badges        Int[]    @default([])

  userActivityLogs UserActivityLog[]

  @@map("User")
}

model Otp {
  id        Int      @id @default(autoincrement())
  Username  String   @unique
  FirstName String
  LastName  String
  Email     String   @unique
  Otp       String
  ExpiresAt DateTime
  Password  String

  @@map("Otp")
}

model Question {
  id            Int    @id @default(autoincrement())
  Title         String
  Description   String
  StarterSchema String
  StarterData   String
  CorrectQuery  String
  EndingSchema  String
}

model TablesInfo {
  id          Int      @id @default(autoincrement())
  tableName   String
  Description String
  querry      String
  CreatedBy   String
  CreatedAt   DateTime @default(now())

  @@map("TablesInfo")
}

model QuestionRecords {
  id               Int               @id @default(autoincrement())
  ContributedBy    String
  Title            String
  TitleLowerCase   String            @default("gaurav kumar")
  Description      String
  Topics           String[]
  UsedTables       String[]
  CreatedAt        DateTime          @default(now())
  DifficultyLevel  String
  Rewards          Int?
  Answer           String?

  userActivityLogs UserActivityLog[]

  @@map("QuestionRecords")
}

model UserActivityLog {
  id         Int      @id @default(autoincrement())
  userId     Int
  questionId Int
  timestamp  DateTime @default(now())
  solution   String
  isValid    Boolean  @default(false)

  user       User             @relation(fields: [userId], references: [id])
  question   QuestionRecords  @relation(fields: [questionId], references: [id])

  @@map("UserActivityLog")
}
